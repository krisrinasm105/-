---
## Author
author:
  name: К.Салькова, Н.Козлова, П. Световидова, Б.Пинега 
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      city: Москва
      
## Title
title: "Отчёт по лабораторной работе №1"
subtitle: «ЗАЩИТА ДАННЫХ ФАЙЛОВОГО СЕРВЕРА"
license: "CC BY"
---

# Цель работы

Освоить практические навыки обнаружения, анализа и устранения последствий компьютерных атак на файловый сервер, изучить методы защиты от уязвимостей и бэкдоров.

# Задание

1. Провести анализ уязвимостей в корпоративной сети.
2. Обнаружить и устранить последствия атаки злоумышленника.
3. Применить меры защиты для файлового сервера.
4. Задокументировать процесс реагирования на инцидент.

# Теоретическое введение

Комплексная защита данных файлового сервера требует:
- **Анализа уязвимостей**: слабые пароли, открытые RDP-порты, устаревшие протоколы (SMBv1).
- **Обнаружения последствий**: meterpreter-сессии, бэкдоры.
- **Мониторинга трафика**: использование IDS (ViPNet IDS NS), SIEM (ViPNet TIAS), Security Onion.
- **Реагирования**: изоляция узлов, обновление ПО, удаление вредоносных процессов.

# Выполнение лабораторной работы

## 1. Подготовка к работе

### 1.1 Изучение схемы сети
Проанализирована логическая схема сети предприятия (Рисунок 1 методического пособия). Определены ключевые узлы:
- Веб-сервер (10.10.1.20)
- Рабочая станция менеджера (10.10.4.11) 
- Файловый сервер (10.10.2.12)
- Внешний шлюз (10.10.1.254)

### 1.2 Настройка инструментов мониторинга
- Запущен ViPNet IDS NS для детектирования сетевых атак
- Настроен ViPNet TIAS для анализа событий безопасности
- Развернут Security Onion для комплексного мониторинга

## 2. Поэтапное выполнение работы

### 2.1 Обнаружение и устранение уязвимостей

#### Шаг 1: Устранение простого пароля пользователя Manager1

**Обнаружение:**
- Подключение к веб-серверу: `ssh root@10.10.1.20`
- Вход в MySQL: `mysql -uroot -p`
- Просмотр БД toppro: `use toppro;`
- Анализ таблицы user: `SELECT * FROM user;`

**Результат:** Обнаружен пользователь Manager1 с простым паролем `qw2121671`

**Устранение:**
- Выполнена команда смены пароля:
```sql
UPDATE user SET password = 'N3wStr0ngP@ss2024!' WHERE name = 'Manager1';
```
- Проверка изменения: `SELECT * FROM user WHERE name = 'Manager1';`


#### Шаг 2: Закрытие уязвимости RDP

**Обнаружение:**
- Проверка открытых портов на Manager Workstation 1
- Обнаружен открытый порт 3389 для внешней сети

**Устранение:**
- Вход на внешний шлюз 10.10.1.254
- Переход в раздел Firewall → Rules
- Отключение правила проброса RDP-трафика


#### Шаг 3: Устранение уязвимости MS17-010

**Обнаружение:**
- Подключение к файловому серверу 10.10.2.12 через RDP
- Проверка статуса SMBv1 в PowerShell:
```powershell
Get-SmbServerConfiguration | Select-Object EnableSMB1Protocol
```

**Результат:** `EnableSMB1Protocol: True`

**Устранение:**
- Выполнена команда отключения SMBv1:
```powershell
Set-SmbServerConfiguration -EnableSMB1Protocol $false
```
- Подтверждение действия: ввод `Y`
- Проверка результата: повторный запуск `Get-SmbServerConfiguration`


### 2.2 Устранение последствий атаки

#### Шаг 4: Ликвидация Meterpreter-сессии

**Обнаружение:**
- На рабочей станции менеджера выполнен `netstat -bno`
- Обнаружено подозрительное соединение с IP 195.239.174.11

**Устранение:**
- Определен PID процесса: 7064
- Завершен процесс: `taskkill /f /pid 7064`
- Проверка отсутствия соединения: повторный `netstat -bno`


#### Шаг 5: Удаление бэкдора на файловом сервере

**Обнаружение:**
- На файловом сервере выполнен `netstat -bno`
- Обнаружен процесс `AM_backdoor.exe` с соединением на 195.239.174.11:6666
- Найден файл в `C:\Windows\Temp\AM_backdoor.exe`

**Устранение:**
- Завершен процесс через Диспетчер задач (PID 3552)
- Удален файл `AM_backdoor.exe`
- Проверка очистки: `netstat -bno` и просмотр папки Temp


### 2.3 Анализ и детектирование атаки

#### Шаг 6: Анализ в ViPNet IDS NS

**Процесс анализа:**
- Просмотр событий в интерфейсе ViPNet IDS NS
- Фильтрация по IP-адресу нарушителя 195.239.174.11
- Анализ временной шкалы атаки

**Обнаруженные события:**
- Сканирование портов (HTTP, RDP, SMB)
- Попытки брутфорса с использованием Hydra
- Эксплуатация уязвимости EternalBlue на порту 445


#### Шаг 7: Анализ в ViPNet TIAS

**Процесс анализа:**
- Импорт событий от ViPNet IDS NS в формате CEF
- Корреляция событий по времени и IP-адресам
- Построение цепочки атаки

**Выявленная последовательность:**
1. Сканирование веб-ресурсов из внешней сети
2. Брутфорс аутентификации на веб-приложении
3. Атака на внутренний хост 10.10.4.11
4. Эксплуатация MS17-010 на файловом сервере 10.10.2.12


#### Шаг 8: Мониторинг в Security Onion

**Процесс анализа:**
- Вход в веб-интерфейс Security Onion
- Использование Squert для анализа событий
- Просмотр деталей пакетов через NetworkMiner

**Ключевые находки:**
- События `ET EXPLOIT ETERNALBLUE`
- Подозрительная активность PowerShell
- Обратные соединения на порты 4444 и 6666

## 3. Проверка эффективности мер защиты

### 3.1 Финальная проверка сети
- Выполнена проверка `netstat -bno` на всех узлах
- Отсутствуют соединения с IP нарушителя
- Проверена работа легитимных служб

### 3.2 Верификация устранения уязвимостей
- Проверка сложности паролей в БД
- Подтверждение закрытия RDP порта
- Проверка отключения SMBv1 протокола

### 3.3 Документирование инцидента
- Составлен полный отчет о проведенной атаке
- Задокументированы примененные меры защиты
- Сформированы рекомендации по предотвращению подобных инцидентов

![1](image/1.png)
![2](image/2.png)
![3](image/3.png)
![4](image/4.png)
![5](image/5.png)
![6](image/6.png)
![7](image/7.png)
![8](image/8.png)
![9](image/9.png)
![10](image/10.png)
![11](image/11.png)
![12](image/12.png)
![13](image/13.png)
![14](image/14.png)
![15](image/15.png)
![16](image/16.png)
![17](image/17.png)
![18](image/18.png)



# Выводы

В ходе лабораторной работы был успешно отработан полный цикл реагирования на киберинцидент:

1. **Обнаружены и устранены 3 ключевые уязвимости:**
   - Простой пароль пользователя веб-приложения
   - Открытый RDP-порт для внешней сети  
   - Уязвимая версия протокола SMBv1

2. **Ликвидированы последствия атаки:**
   - Завершена meterpreter-сессия
   - Удален бэкдор с файлового сервера

3. **Освоены инструменты мониторинга:**
   - ViPNet IDS NS для детектирования сетевых атак
   - ViPNet TIAS для анализа цепочек событий
   - Security Onion для комплексного мониторинга

4. **Получены практические навыки:**
   - Анализа сетевого трафика
   - Работы с системами обнаружения вторжений
   - Реагирования на инциденты информационной безопасности

Работа продемонстрировала важность комплексного подхода к защите корпоративной инфраструктуры и необходимость регулярного аудита безопасности.

# Список литературы{.unnumbered}

::: {#refs}
1. Методическое пособие по лабораторной работе №2
:::